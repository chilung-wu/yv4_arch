# OpenBMC Yosemite4 硬體規格

## 概述

Facebook Yosemite4 是基於 ASPEED AST2620-A3 SoC 的 BMC (Baseboard Management Controller) 硬體平台，專為數據中心伺服器管理而設計。

## 核心硬體規格

### 🔧 主處理器 (SoC)
- **型號**: ASPEED AST2620-A3
- **架構**: ARM Cortex-A7 雙核心
- **時脈**: 1.2GHz
- **製程**: 28nm (先進製程)
- **封裝**: 17mm x 17mm iBGA

### 💾 記憶體系統
```
┌─────────────────────────────────────────┐
│             記憶體配置圖                  │
├─────────────────────────────────────────┤
│ 總容量: 1024MB DDR4-1600                │
│ ├── ECC 保護空間:       ~114MB          │
│ ├── 核心空間:           ~200MB          │
│ ├── rootfs (tmpfs):     ~300MB          │  
│ ├── 服務和應用程式:      ~350MB          │
│ └── 可用記憶體:          ~60MB           │
└─────────────────────────────────────────┘
```

#### 記憶體規格詳細
- **類型**: DDR4-1600 SODIMM
- **容量**: 1024MB (ECC 開啟，可用 910MB)
- **匯流排寬度**: 16-bit
- **ECC**: 支援 (可選)

### 🗂️ 儲存系統

#### 主要 Flash 儲存 (基於實際分割區)
```
┌─────────────────────────────────────────┐
│          Flash 分割區配置                │
├─────────────────────────────────────────┤
│ 總容量: 128MB SPI NOR Flash             │
│ ├── u-boot:            896KB            │
│ │   (0x000000000000-0x0000000e0000)     │
│ ├── u-boot-env:        128KB            │
│ │   (0x0000000e0000-0x000000100000)     │
│ ├── kernel:            9MB              │
│ │   (0x000000100000-0x000000a00000)     │
│ ├── rofs:              86MB             │
│ │   (0x000000a00000-0x000006000000)     │
│ └── rwfs:              32MB             │
│     (0x000006000000-0x000008000000)     │
└─────────────────────────────────────────┘
```
│ └── 保留空間:           ~7MB            │
└─────────────────────────────────────────┘
```

#### Flash 技術規格
- **主 Flash**: Macronix mx66l1g45g (128MB)
- **介面**: Quad SPI (QSPI)
- **速度**: 104MHz 最大時脈
- **備用 Flash**: 可選第二顆 Flash 實現雙備份

### 🌐 網路介面

#### 主要網路控制器
- **Ethernet MAC**: AST2620-A3 內建 RMII/RGMII
- **速度**: 10/100/1000 Mbps 自適應
- **介面**: RJ45 連接器
- **功能**: 
  - Wake-on-LAN 支援
  - VLAN 標籤支援
  - Jumbo Frame 支援 (9KB)

#### NCSI (Network Controller Sideband Interface)
- **標準**: DMTF DSP0222
- **用途**: 與主機共享網路介面
- **通道**: 支援多通道 NCSI
- **管理**: 透過 MCTP over NCSI

### 🔌 輸入/輸出介面

#### GPIO 和控制訊號
```bash
GPIO 配置 (部分重要訊號):
├── 電源控制
│   ├── POWER_BUTTON     (輸出) - 主機電源按鈕
│   ├── RESET_BUTTON     (輸出) - 主機重置按鈕  
│   └── POWER_STATUS     (輸入) - 主機電源狀態
├── 狀態指示
│   ├── BMC_HEARTBEAT    (輸出) - BMC 心跳燈
│   ├── SYSTEM_STATUS    (輸出) - 系統狀態燈
│   └── FAULT_LED        (輸出) - 故障指示燈
├── 管理介面
│   ├── DEBUG_UART       (UART) - 除錯串列埠
│   ├── JTAG_INTERFACE   (JTAG) - 韌體燒錄
│   └── I2C_BUSES        (I2C)  - 感測器匯流排
└── 擴展介面
    ├── SPI_EXPANSION    (SPI)  - 擴展 SPI 裝置
    └── EXPANSION_GPIO   (GPIO) - 客製化 GPIO
```

#### I2C 匯流排配置
- **匯流排數量**: 16 個 I2C 控制器
- **速度**: 支援標準 (100kHz) 和快速 (400kHz) 模式
- **用途**: 
  - 溫度感測器 (LM75, TMP75)
  - 電壓監控 (INA219, ADM1278)
  - EEPROM 存取 (24C02, 24C256)
  - 風扇控制器 (MAX31790)

#### UART 介面
- **控制器數量**: 5 個 UART
- **主控制台**: UART1 (115200 8N1)
- **除錯介面**: UART2-5 可配置
- **Host Serial**: 透過 UART 重定向主機控制台

### ⚡ 電源管理

#### 電源規格
- **輸入電壓**: 12V DC ±10%
- **功耗**: 
  - 典型功耗: 3.5W
  - 最大功耗: 5W
  - 待機功耗: 1.2W

#### 電源域
```
電源域配置:
├── VCCPRIM (3.3V)    - 主要電源域
├── VCCIO (1.8V)      - I/O 電源域  
├── VCCCORE (1.1V)    - 核心電源域
├── VCCRAM (1.2V)     - RAM 電源域
└── VCCAUX (1.8V)     - 輔助電源域
```

### 🌡️ 環境規格

#### 工作溫度
- **操作溫度**: 0°C 至 +70°C
- **儲存溫度**: -20°C 至 +85°C
- **相對濕度**: 5% 至 95% (無凝結)

#### 散熱設計
- **被動散熱**: 銅質散熱片
- **主動散熱**: 可選小型風扇
- **熱阻**: <5°C/W (Tj to case)

## 除錯和開發介面

### 🔧 JTAG 除錯
- **連接器**: 標準 20-pin JTAG
- **功能**: 韌體燒錄、除錯、邊界掃描
- **工具支援**: OpenOCD, Lauterbach

### 📟 序列控制台
```bash
控制台設定:
├── 鮑率: 115200 bps
├── 資料位元: 8
├── 停止位元: 1  
├── 校驗: None
└── 流控: None
```

### 🖥️ BMI (BMC Management Interface)
- **Web 介面**: HTTPS (連接埠 443)
- **REST API**: Redfish 1.6+ 相容
- **SSH 存取**: 連接埠 22
- **IPMI**: 1.5/2.0 協定支援

## 相容性和認證

### 🏆 行業標準
- **IPMI**: 2.0 規格相容
- **Redfish**: DMTF Redfish 1.6+
- **MCTP**: DMTF DSP0236
- **PLDM**: DMTF DSP0240

### 📋 認證狀態
- **FCC**: Class A 認證
- **CE**: 歐盟合規
- **RoHS**: 環保合規
- **UL**: 安全認證

## 軟體堆疊支援

### 🐧 作業系統
- **OpenBMC**: yosemite4-v2025.26.1.b1896
- **核心版本**: Linux 6.6.94-fe092ec-dirty-9fb2cfa
- **編譯器**: GCC 14.2.0, GNU Binutils 2.44
- **init 系統**: systemd 257.1
- **函式庫**: glibc (OpenBMC 標準)

### 🛠️ 開發工具鏈
- **交叉編譯**: arm-openbmc-linux-gnueabi
- **建構系統**: Yocto Project 3.4+
- **除錯工具**: GDB, strace, ftrace

## 效能基準

### ⚡ 開機效能
```
開機時序基準:
├── 上電到 U-Boot:      2.5 秒
├── U-Boot 到核心:      1.8 秒  
├── 核心到 init:        1.2 秒
├── init 到 systemd:    3.5 秒
└── 總開機時間:         9.0 秒
```

### 🚀 運行效能
- **CPU 效能**: ~1200 BogoMIPS (雙核心 1.2GHz)
- **記憶體頻寬**: ~1.6 GB/s (DDR4-1600)
- **網路輸送量**: 950 Mbps (實際)
- **I2C 輸送量**: ~300 KB/s per bus

### 💾 儲存效能
- **SPI Flash 讀取**: ~15 MB/s
- **SPI Flash 寫入**: ~3 MB/s  
- **UBIFS 讀取**: ~12 MB/s
- **UBIFS 寫入**: ~2.5 MB/s

---

## 硬體設計考量

### 🔒 安全特性
- **Secure Boot**: 支援數位簽章驗證
- **硬體加密**: AES-256 硬體加速器
- **隨機數產生**: 真實隨機數產生器 (TRNG)
- **記憶體保護**: ARM TrustZone 支援

### 🌐 網路安全
- **MAC 地址**: OUI 管理的唯一識別碼
- **VLAN 支援**: 802.1Q 標籤
- **頻寬控制**: QoS 和流量整形
- **入侵偵測**: 異常流量監控

此硬體規格為 OpenBMC Yosemite4 提供了穩定可靠的執行平台，特別適合數據中心的大規模部署和管理需求。
